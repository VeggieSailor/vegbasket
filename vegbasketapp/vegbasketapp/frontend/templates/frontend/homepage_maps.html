{% load static %}<html>
<script src="{% static "js/jquery.js"%}"></script>
<link rel="stylesheet" href="{% static "transformer/leaflet/leaflet.css" %}" />
<div id="map" style="height:100%"></div>
<script src="{% static "transformer/leaflet/leaflet.js" %}"></script>    
<script>
<!--var map = L.map('map').setView([{{ cords.lat }}, {{ cords.lng }}], 15);-->

var icons = [];

var lngDefault = 51.507351;
var latDefault = -0.127758;
var zoomDefault = 16;

var icon = L.icon({iconUrl: '{% static "frontend/img/markers/marker0.png" %}'});
icons[0] = L.icon({iconUrl: '{% static "frontend/img/markers/marker0.png" %}'});
icons[1] = L.icon({iconUrl: '{% static "frontend/img/markers/marker1.png" %}'});
icons[2] = L.icon({iconUrl: '{% static "frontend/img/markers/marker2.png" %}'});
icons[3] = L.icon({iconUrl: '{% static "frontend/img/markers/marker3.png" %}'});
icons[4] = L.icon({iconUrl: '{% static "frontend/img/markers/marker4.png" %}'});
icons[5] = L.icon({iconUrl: '{% static "frontend/img/markers/marker5.png" %}'});

var map = L.map('map');
L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
}).addTo(map);

        map.setView(new L.LatLng(51.3, 0.7),zoomDefault);


if ("geolocation" in navigator) {
<!--alert("Fuck yes");-->
 navigator.geolocation.getCurrentPosition(function(position) {
 map.setView(new L.LatLng(position.coords.latitude, position.coords.longitude),zoomDefault);
 var marker = L.marker([position.coords.latitude, position.coords.longitude]).addTo(map);
http://localhost:8000/vegapi/?long=2.1941695&lat=41.3892221
$.ajax({
  url: "/vegapi/?long="+position.coords.longitude+"&lat="+position.coords.latitude,
  dataType: "json",
  context: document.body
}).done(function(data) {

  <!--alert(data);-->
  $.each(data['places'],function(datad)
    {
    <!--console.log(datad);-->
    <!--console.log(data['places'][datad]['long']);-->
    <!--console.log(data['places'][datad]['lat']);-->
    var lng = data['places'][datad]['long'];
    var lat = data['places'][datad]['lat'];
    var level = data['places'][datad]['level'];
    var marker = L.marker([lat, lng], {icon: icons[level]}).addTo(map);
    }
  )
});
 
 
 
 
},function(datae){
 map.setView(new L.LatLng(lngDefault, latDefault),zoomDefault);
 var marker = L.marker([lngDefault, latDefault]).addTo(map);
http://localhost:8000/vegapi/?long=2.1941695&lat=41.3892221
$.ajax({
  url: "/vegapi/?long="+latDefault+"&lat="+lngDefault,
  dataType: "json",
  context: document.body
}).done(function(data) {

  <!--alert(data);-->
  $.each(data['places'],function(datad)
    {
    <!--console.log(datad);-->
    <!--console.log(data['places'][datad]['long']);-->
    <!--console.log(data['places'][datad]['lat']);-->
    var lng = data['places'][datad]['long'];
    var lat = data['places'][datad]['lat'];
    var level = data['places'][datad]['level'];
    var marker = L.marker([lat, lng], {icon: icons[level]}).addTo(map);
    }
  )
});}
);





} else {

 
 
 
 




}

</script>

<!--<iframe style="margin-bottom:5px" width="100%" height="98%" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="https://www.openstreetmap.org/export/embed.html?bbox={{ cords.lng }}%2C{{ cords.lat }}%2C{{ cords.lng }}%2C{{ cords.lat }}&amp;layer=mapnik&amp;marker={{ cords.lat }}%2C{{ cords.lng }}" style="border: 1px solid black"></iframe>-->


</html>
